<!DOCTYPE html>
<html lang="en">
<head>
	<% var username = username; var user = user; var allEvents = allEvents %>
	<% include ./partials/head %>
</head>
<body class="container">

	<header>
		<% include ./partials/flash %>
		<% include ./partials/header %>
	</header>

	<main>
		<div class="row">
			<div class="col-sm-8">

				<div class="jumbotron">
					<h1>Upcoming CS Events</h1>

					<% for(var i=0; i < allEvents.length; i++) { %>
						
						<!-- Individual event div -->
						<article id="event-<%= allEvents[i]._id %>">
						
							<!-- Event Name -->
							<h3><%= allEvents[i].name %></h3>
							
							<p>
							
								<!-- Start/end date and time -->
								<% if (allEvents[i].endTime == null) { %>
									<!-- No end date specified -->
									<%= getDateTimePrettyFormat(allEvents[i].startTime) %>
								<% } else if (getDateTimeStr(allEvents[i].startTime).substr(0,10) == getDateTimeStr(allEvents[i].endTime).substr(0,10)) { %>
									<!-- Same start/end dates -->
									<%= getDateTimePrettyFormat(allEvents[i].startTime) %> - <%= getDateTimePrettyFormat(allEvents[i].endTime).substr(16) %>
								<% } else { %>
									<!-- Different start/end dates -->
									<%= getDateTimePrettyFormat(allEvents[i].startTime) %> - <%= getDateTimePrettyFormat(allEvents[i].endTime) %>
								<% } %>
								
								<!-- Location (required) -->
								<br><%= allEvents[i].location %>

								<!-- RSVP Limit -->
								<% if (allEvents[i].rsvpLimit != null) { %><br>RSVP Limit: ##/<%= allEvents[i].rsvpLimit %><% } %>
								
								<!-- Description -->
								<% if (allEvents[i].description != null) { %><br><%= allEvents[i].description %><% } %>


							</p>

							<% if (user && user.roles.type.user) {%>
								<button id=<%= "show-" + allEvents[i]._id %> class="btn btn-default" onclick="location.href='/event/<%= allEvents[i]._id %>'"><i class="fa fa-eye"></i> Show Event</button>
							<% } %>
							<% if (user && user.roles.type.admin || user.roles.type.superuser) { %>
								<button id=<%= "edit-" + allEvents[i]._id %> class="btn btn-default" onclick="location.href='/event/<%= allEvents[i]._id %>/edit'"><i class="fa fa-edit"></i> Edit Event</button>
								<form action="/event/<%= allEvents[i]._id %>/delete" method="POST" display="none" style="display: inline-block">
									<button id=<%= "delete-" + allEvents[i]._id %> class="btn btn-danger"><i class="fa fa-trash"></i> Delete Event</button>
								</form>
							<% } %>
							
						<% } %>
					
					</article>
				</div>
			</div>
			<div class="col-sm-4">

				<div class="well">
					<h3>Look I'm A Sidebar!</h3>
				</div>

			</div>
		</div>
	</main>

	<footer>
		<% include ./partials/footer %>
	</footer>

</body>
</html>
